{% extends "base.html" %} {% block title %}Dashboard - Hệ thống điểm danh khuôn mặt{% endblock %} {% block content %}
<div class="container-fluid px-4">
  <!-- Header -->
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-4 pb-3 mb-5">
    <h1 class="h2 text-gradient fade-in mb-0"><i class="bi bi-speedometer2 icon-dashboard me-3"></i>Dashboard</h1>
    <div class="btn-toolbar">
      <a href="{{ url_for('camera') }}" class="btn btn-success btn-lg shadow-medium hover-lift px-4"> <i class="bi bi-camera-fill icon-camera me-2"></i>Điểm danh ngay </a>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="row mb-5 g-4">
    <div class="col-xl-3 col-md-6">
      <div class="card glass-card border-left-primary shadow-strong h-100 hover-lift scale-in">
        <div class="card-body p-4">
          <div class="row no-gutters align-items-center">
            <div class="col-8">
              <div class="text-xs font-weight-bold text-primary text-uppercase mb-3 ls-1">Tổng số lớp học</div>
              <div class="h2 mb-0 font-weight-bold text-gradient">{{ stats.total_classes }}</div>
            </div>
            <div class="col-4 text-end">
              <i class="bi bi-building icon-school" style="font-size: 3.5rem; opacity: 0.7"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-md-6">
      <div class="card glass-card border-left-success shadow-strong h-100 hover-lift scale-in" style="animation-delay: 0.1s">
        <div class="card-body p-4">
          <div class="row no-gutters align-items-center">
            <div class="col-8">
              <div class="text-xs font-weight-bold text-success text-uppercase mb-3 ls-1">Tổng sinh viên</div>
              <div class="h2 mb-0 font-weight-bold text-gradient">{{ stats.total_students }}</div>
            </div>
            <div class="col-4 text-end">
              <i class="bi bi-mortarboard-fill icon-student" style="font-size: 3.5rem; opacity: 0.7"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-md-6">
      <div class="card glass-card border-left-info shadow-strong h-100 hover-lift scale-in" style="animation-delay: 0.2s">
        <div class="card-body p-4">
          <div class="row no-gutters align-items-center">
            <div class="col-8">
              <div class="text-xs font-weight-bold text-info text-uppercase mb-3 ls-1">Tổng môn học</div>
              <div class="h2 mb-0 font-weight-bold text-gradient">{{ stats.total_subjects }}</div>
            </div>
            <div class="col-4 text-end">
              <i class="bi bi-book-fill icon-book" style="font-size: 3.5rem; opacity: 0.7"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-md-6">
      <div class="card glass-card border-left-warning shadow-strong h-100 hover-lift scale-in" style="animation-delay: 0.3s">
        <div class="card-body p-4">
          <div class="row no-gutters align-items-center">
            <div class="col-8">
              <div class="text-xs font-weight-bold text-warning text-uppercase mb-3 ls-1">Ca điểm danh hôm nay</div>
              <div class="h2 mb-0 font-weight-bold text-gradient">{{ stats.today_sessions }}</div>
            </div>
            <div class="col-4 text-end">
              <i class="bi bi-calendar-check-fill icon-attendance" style="font-size: 3.5rem; opacity: 0.7"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="row mb-5">
    <div class="col-12">
      <div class="card glass-card shadow-strong slide-up">
        <div class="card-header bg-gradient-primary text-white py-4">
          <h4 class="m-0 font-weight-bold"><i class="bi bi-lightning-fill me-3" style="font-size: 1.8rem"></i>Thao tác nhanh</h4>
        </div>
        <div class="card-body p-5">
          <div class="row g-4">
            <div class="col-lg-3 col-md-6">
              <a href="{{ url_for('classes.add_class') }}" class="btn btn-outline-primary btn-lg w-100 h-100 d-flex flex-column align-items-center justify-content-center hover-lift shadow-medium" style="min-height: 160px; border-width: 2px; border-radius: 20px">
                <i class="bi bi-plus-circle-fill icon-plus mb-3" style="font-size: 3.5rem"></i>
                <span class="fw-bold fs-5">Thêm lớp học</span>
              </a>
            </div>
            <div class="col-lg-3 col-md-6">
              <a href="{{ url_for('students.add_student') }}" class="btn btn-outline-success btn-lg w-100 h-100 d-flex flex-column align-items-center justify-content-center hover-lift shadow-medium" style="min-height: 160px; border-width: 2px; border-radius: 20px">
                <i class="bi bi-person-plus-fill icon-student mb-3" style="font-size: 3.5rem"></i>
                <span class="fw-bold fs-5">Thêm sinh viên</span>
              </a>
            </div>
            <div class="col-lg-3 col-md-6">
              <a href="{{ url_for('attendance.add_session') }}" class="btn btn-outline-warning btn-lg w-100 h-100 d-flex flex-column align-items-center justify-content-center hover-lift shadow-medium" style="min-height: 160px; border-width: 2px; border-radius: 20px">
                <i class="bi bi-calendar-plus-fill icon-attendance mb-3" style="font-size: 3.5rem"></i>
                <span class="fw-bold fs-5">Tạo ca điểm danh</span>
              </a>
            </div>
            <div class="col-lg-3 col-md-6">
              <a href="{{ url_for('camera') }}" class="btn btn-outline-danger btn-lg w-100 h-100 d-flex flex-column align-items-center justify-content-center hover-lift shadow-medium" style="min-height: 160px; border-width: 2px; border-radius: 20px">
                <i class="bi bi-camera-fill icon-camera mb-3" style="font-size: 3.5rem"></i>
                <span class="fw-bold fs-5">Điểm danh ngay</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Attendance -->
  <div class="row">
    <div class="col-12">
      <div class="card glass-card shadow-strong fade-in">
        <div class="card-header bg-gradient-primary text-white py-4">
          <h4 class="m-0 font-weight-bold"><i class="bi bi-clock-history me-3" style="font-size: 1.8rem"></i>Điểm danh gần đây</h4>
        </div>
        <div class="card-body p-0">
          {% if stats.recent_attendance %}
          <div class="table-responsive">
            <table class="table table-hover mb-0" style="font-size: 1rem">
              <thead style="background-color: #f8f9fa">
                <tr>
                  <th class="px-4 py-4 border-0">
                    <i class="bi bi-clock icon-chart me-2"></i>
                    <strong>Thời gian</strong>
                  </th>
                  <th class="px-4 py-4 border-0">
                    <i class="bi bi-person-badge icon-student me-2"></i>
                    <strong>MSSV</strong>
                  </th>
                  <th class="px-4 py-4 border-0">
                    <i class="bi bi-person icon-student me-2"></i>
                    <strong>Họ tên</strong>
                  </th>
                  <th class="px-4 py-4 border-0">
                    <i class="bi bi-building icon-school me-2"></i>
                    <strong>Lớp</strong>
                  </th>
                  <th class="px-4 py-4 border-0">
                    <i class="bi bi-book icon-book me-2"></i>
                    <strong>Môn học</strong>
                  </th>
                  <th class="px-4 py-4 border-0 text-center">
                    <i class="bi bi-check-circle icon-plus me-2"></i>
                    <strong>Trạng thái</strong>
                  </th>
                </tr>
              </thead>
              <tbody>
                {% for record in stats.recent_attendance %}
                <tr style="border-bottom: 1px solid #e9ecef">
                  <td class="px-4 py-4">
                    <span class="fw-medium text-dark">{{ record.attendance_time }}</span>
                  </td>
                  <td class="px-4 py-4">
                    <span class="badge bg-light text-dark fw-bold px-3 py-2" style="font-size: 0.9rem"> {{ record.student_id }} </span>
                  </td>
                  <td class="px-4 py-4">
                    <span class="fw-bold text-primary fs-6">{{ record.full_name }}</span>
                  </td>
                  <td class="px-4 py-4">
                    <span class="text-dark">{{ record.class_name }}</span>
                  </td>
                  <td class="px-4 py-4">
                    <span class="text-dark">{{ record.subject_name }}</span>
                  </td>
                  <td class="px-4 py-4 text-center">
                    <span class="badge bg-gradient-success px-3 py-2" style="font-size: 0.9rem"> <i class="bi bi-check-circle-fill me-1"></i>{{ record.status }} </span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="text-center py-5 px-4">
            <div class="mb-4">
              <i class="bi bi-inbox icon-chart" style="font-size: 5rem; opacity: 0.4"></i>
            </div>
            <h4 class="text-muted mb-3 fw-bold">Chưa có lịch sử điểm danh</h4>
            <p class="text-muted mb-4 fs-5">Bắt đầu điểm danh để xem dữ liệu tại đây</p>
            <a href="{{ url_for('camera') }}" class="btn btn-primary btn-lg shadow-medium hover-lift px-5 py-3"> <i class="bi bi-camera-fill icon-camera me-2"></i>Bắt đầu điểm danh </a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
